<div class="chart-container shadow-xs mx-auto max-w-4xl overflow-hidden p-6">
  <div class="mb-6 flex flex-col items-start justify-between sm:flex-row sm:items-center">
    <div class="mb-4 flex flex-col items-start space-y-2 sm:mb-0 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4">
      <h2 class="text-primary text-lg font-semibold">{{ chartTitle() }}</h2>
    </div>
    <div class="relative w-full sm:w-28">
      <select
        (change)="onFilterChange($event)"
        class="filter-date w-full cursor-pointer appearance-none rounded-lg border border-gray-300 bg-white py-2 px-4 pr-8 text-sm font-medium leading-tight text-[#230448] focus:border-[#5AA454] focus:outline-none">
        @for (option of filterOptions(); track option.value) {
        <option [value]="option.value" [selected]="option.value === 'year'">{{ option.label }}</option>
        }
      </select>
      <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-[#230448]">
        <svg class="h-4 w-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
          <path d="M9.293 12.95l.707.707L15 9.707l-1.414-1.414L10 12.586l-3.586-3.586L5 9.707z"></path>
        </svg>
      </div>
    </div>
  </div>

  <div class="-ml-4 h-[350px] w-full">
    <ngx-charts-area-chart
      [view]="view()"
      [scheme]="colorScheme()"
      [results]="chartData()"
      [gradient]="gradient()"
      [xAxis]="showXAxis()"
      [tooltipDisabled]="false"
      [yAxis]="showYAxis()"
      [seriesTooltipTemplate]="customTooltip"
      [tooltipTemplate]="customTooltip"
      [showXAxisLabel]="showXAxisLabel()"
      [showYAxisLabel]="showYAxisLabel()"
      [xAxisLabel]="xAxisLabel()"
      [yAxisLabel]="yAxisLabel()"
      [animations]="animations()">
    </ngx-charts-area-chart>
    <ng-template #tooltipTemplate let-model="model">
      <div class="tooltip">
        {{ model.series }}<br />
        {{ model.name | date : 'HH:mm' }} Uhr · {{ model.name | date : 'dd.MM.yyyy' }} · {{ model.value }}
      </div>
    </ng-template>
    <ng-template #customTooltip let-model="model">
      <div class="custom-tooltip-container">
        <div class="tooltip-header">
          <strong>{{ model.name }}</strong>
        </div>
        <div class="tooltip-body">
          <span>{{ model.value | number }} units</span>
          <br />
          <span class="tooltip-value-date">{{ model.series }}</span>
        </div>
      </div>
    </ng-template>
  </div>
</div>
