<section
  class="rounded-3xl shadow-[0_8px_24px_rgba(12,6,79,0.08)] border border-violet-100 bg-white p-6 sm:p-8 {{
    tableWidthClass
  }} {{ cardClass }}">
  <header class="mb-4 flex items-center justify-between">
    <div class="min-w-0">
      <h3 class="text-primary truncate text-[18px] font-semibold leading-6">{{ title }}</h3>
      <p *ngIf="subtitle" class="mt-1 text-xs text-[#7C6EAA]">{{ subtitle }}</p>
    </div>
    <button
      *ngIf="ctaLabel"
      type="button"
      (click)="ctaClick.emit()"
      class="bg-primary inline-flex items-center rounded-full px-4 py-2 text-xs font-semibold text-white hover:brightness-110 focus:outline-none focus-visible:ring-2 focus-visible:ring-violet-300">
      {{ ctaLabel }}
    </button>
  </header>

  <div class="relative overflow-x-auto rounded-2xl">
    <table class="w-full table-fixed">
      <thead class="text-primary text-sm font-medium">
        <tr class="h-10">
          <th
            *ngFor="let col of columns"
            scope="col"
            [attr.aria-label]="col.ariaLabel || col.header"
            class="px-4 text-left"
            [ngClass]="[
              col.align === 'right' ? 'text-right' : col.align === 'center' ? 'text-center' : 'text-left',
              col.widthClass || ''
            ]">
            {{ col.header }}
          </th>
        </tr>
      </thead>
      <tbody class="text-sm font-normal text-[#230448CC]">
        <tr
          *ngFor="let row of rows; let i = index; trackBy: trackByIndex"
          class="h-[64px] transition-colors"
          [ngClass]="rowClass(i)"
          (click)="rowClick.emit(row)">
          <td
            *ngFor="let col of columns"
            class="px-4 align-middle"
            [ngClass]="[col.align === 'right' ? 'text-right' : col.align === 'center' ? 'text-center' : 'text-left']"
            (click)="$event.stopPropagation(); emitCellClick(row, col, $event)">
            <ng-container *ngIf="getTpl(col.templateName) as tpl; else defaultCell">
              <ng-container
                [ngTemplateOutlet]="tpl"
                [ngTemplateOutletContext]="{ $implicit: row, row: row, col: col, table: this }"></ng-container>
            </ng-container>
            <ng-template #defaultCell>
              <ng-container *ngIf="col.key === 'status'; else generic">
                <span
                  class="inline-flex items-center rounded-full border-0 px-2.5 py-1 text-[11px] font-semibold"
                  [ngClass]="styleForStatus(row[col.key])">
                  {{ row[col.key] }}
                </span>
              </ng-container>
              <ng-template #generic>
                <span class="block truncate">{{ row[col.key] }}</span>
              </ng-template>
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
